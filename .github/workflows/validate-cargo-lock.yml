name: Validate Cargo.lock
on: [push]

concurrency:
  group: ${{ github.workflow }}-${{ github.event.pull_request.number || github.ref }}
  cancel-in-progress: true

jobs:
  validate-cargo-lock:
    name: Validate Cargo.lock Consistency
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Install Rust toolchain
        run: |
          rustup toolchain install nightly-2023-06-01 --no-self-update --profile=minimal
          rustup default nightly-2023-06-01

      - name: Validate Cargo.lock
        run: |
          echo "Checking if Cargo.lock is up-to-date..."
          cargo update -w --locked
        shell: bash
